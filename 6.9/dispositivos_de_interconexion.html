<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>3. Dispositivos de interconexión</title><meta name="generator" content="DocBook XSL Stylesheets V1.68.1"><link rel="start" href="index.html" title="La distribución Aprendiendo de Jesús como servidor y cortafuegos"><link rel="up" href="index.html" title="La distribución Aprendiendo de Jesús como servidor y cortafuegos"><link rel="prev" href="redes_protocolos_e_internet.html" title="2. Redes, protocolos e Internet"><link rel="next" href="section.html" title="4. "></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">3. Dispositivos de interconexión</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="redes_protocolos_e_internet.html">Anterior</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="section.html">Siguiente</a></td></tr></table><hr></div><div class="sect1" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dispositivos_de_interconexion"></a>3. Dispositivos de interconexión</h2></div></div></div><p>
    Durante el arranque, OpenBSD detecta la gran mayoría de dispositivos
    conectados a un computador. Una vez en operación puede examinar la
    detección con <code class="literal">dmesg</code>.
  </p><p>
    Si durante el arranque algún dispositivo no es detectado o es
    detectado incorrectamente, puede intentar hacer modificaciones
    durante el arranque iniciando con <code class="literal">bsd -c</code> cuando
    esté en el prompt de arranque del programa <code class="literal">boot</code>
    (ver <a href="biblio.html" title="B. Bibliografía">usuario_OpenBSD</a>).
  </p><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="modem-nulo"></a>3.1. Conexión con un módem nulo</h3></div></div></div><p>
      Para conectar una terminal a un sistema OpenBSD puede emplearse un
      módem nulo. La terminal puede ser un computador con OpenBSD o con
      cualquier otro sistema operativo y un programa que permita ver la
      información que llegue a un puerto serial y enviar la que se
      teclee (por ejemplo sirven varios programas para comunicarse vía
      módem).
    </p><div class="sect3" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="modem-nulo-hardware"></a>3.1.1. Módem Nulo</h4></div></div></div><p>
        Un módem nulo es un cable serial que tiene en sus extremos dos
        conectores hembra para puerto serial y que intercambia algunas
        conexiones. Si ambos conectores son de 25 pines, todos los
        cables deben estar sueltos excepto:
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            (DSR) 6 &amp; (DCD) 8 – 20,
          </p></li><li><p>
            (TxD) 2 – 3,
          </p></li><li><p>
            (RxD) 3 – 2,
          </p></li><li><p>
            (RTS) 4 – 5,
          </p></li><li><p>
            (CTS) 5 – 4,
          </p></li><li><p>
            (SG) 7 – 7,
          </p></li><li><p>
            (DTR) 20 – 6 &amp; 8.
          </p></li></ul></div><p>
        En un conector de 9 pines la nomenclatura es: 1 DCD, 2 TxD, 3
        RxD, 4 DTR, 5 SG, 6 DSR, 7 RTS y 8 CTS.
      </p><p>
        Un módem nulo mínimo sólo requiere que se conecten SG - SG
        (tierra), TxD - RxD (transmisión de uno con recepción del otro)
        y RxD - TxD. Sin embargo para poder efectuar control de flujo
        también deben conectarse los demás.
      </p><p>
        Aunque en el comercio es posible comprar un módem nulo, también
        es relativamente fácil ensamblar uno, una vez tenga conectores,
        cable y cautín. Si hace su propio módem nulo puede probar que la
        conexión haya quedado bien empleando un óhmetro.
      </p><p>
        Una vez se conecte un módem nulo puede probarlo enviando
        mensajes por el puerto serial del uno y viendo lo que recibe en
        el otro. Por ejemplo si conecta dos sistemas OpenBSD empleando
        en ambos el primer puerto serial, en uno de los dos puede
        ejecutar (como usuario <code class="literal">root</code>)
      </p><pre class="programlisting">
    cat &lt; /dev/cua00
</pre><p>
        mientras que en el otro ejecute
      </p><pre class="programlisting">
    cat &gt; /dev/cua00
</pre><p>
        cuando escriba en el segundo y presione ENTER, en el primero
        recibirá el mensaje y líneas en blanco (<code class="literal">cat</code>
        no es el programa apropiado para establecer la comunicación,
        sólo para probar).
      </p></div><div class="sect3" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="servidor"></a>3.1.2. Servidor</h4></div></div></div><p>
        Con un módem nulo conectado y funcionado puede configurarse un
        sistema OpenBSD como servidor para que permita conectar
        terminales a un puerto serial. Debe configurarse el programa
        <code class="literal">init</code> para que durante el arranque ejecute un
        programa que reciba conexiones por el puerto serial (tal
        programa normalmente es <code class="literal">getty</code>).
      </p><p>
        Basta editar el archivo <code class="literal">/etc/ttys</code>, quitar el
        comentario a la línea apropiada para que quede:
      </p><pre class="programlisting">
    tty00   "/usr/libexec/getty std.9600"   vt220 on secure
</pre><p>
        Después puede reiniciar el sistema o reiniciar
        <code class="literal">init</code> con: <code class="literal">kill -HUP 1</code>.
      </p><p>
        En la línea modificada a <code class="literal">/etc/ttys</code>,
        <code class="literal">tty00</code> se refiere a
        <code class="literal">/dev/tty00</code> (i.e el dispositivo del primer
        puerto serial); <code class="literal">/usr/libexec/getty std.9600</code>
        es la orden por ejecutar al arranque para manejar ese
        dispositivo<sup>[<a name="idp1667258320" href="#ftn.idp1667258320">16</a>]</sup>; <code class="literal">vt220</code> indica el tipo de terminal
        que se conectará; <code class="literal">on</code> y
        <code class="literal">secure</code> son banderas<sup>[<a name="idp1667470800" href="#ftn.idp1667470800">17</a>]</sup> para <code class="literal">init</code>, el primero indica que
        se esperan conexiones por esa línea tty y el segundo indica que
        puede iniciar conexiones el usuario root.
      </p></div><div class="sect3" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="Terminal"></a>3.1.3. Terminal</h4></div></div></div><p>
        Una vez conectado su módem nulo a un servidor OpenBSD ya
        configurado para recibir conexiones por el puerto serial, puede
        conectar una terminal.
      </p><p>
        Si la terminal cuenta con un sistema operativo, puede emplear un
        programa de comunicaciones. Con este debe poder ver los mensajes
        de login del servidor. Desde ahí puede entrar como un usuario de
        ese sistema y trabajar como en una de las consolas virtuales
        (sin ambiente X).
      </p><p>
        Si el computador que va a conectar es un sistema OpenBSD puede
        emplear el programa <code class="literal">tip</code> como usuario root:
      </p><pre class="programlisting">
    tip tty0 
</pre><p>
        Es posible que tenga que intentar varias veces, si configura el
        servidor con una velocidad diferente puede especificarla por
        ejemplo con <code class="literal">tip -38400 tty0</code>
      </p><p>
        <code class="literal">tip</code> empleará la descripción de
        <code class="literal">tty0</code> disponible en
        <code class="literal">/etc/remote</code> (que por defecto está configurado
        para representar el primer puerto serial). Le permitirá ver la
        información que el servidor envíe, enviar información al
        servidor y hacer algunas operaciones especiales comenzando con
        el caracter “<span class="quote">~</span>”. Por ejemplo terminar la sesión con
        “<span class="quote">~.</span>”, enviar un archivo con “<span class="quote">~p</span>” o
        recibir un archivo con “<span class="quote">~g</span>”.
      </p><p>
        Dado que puede haber inconvenientes enviando o recibiendo
        archivos de 8 bits, los archivos (especialmente binarios) que
        envíe o reciba con <code class="literal">tip</code> debe codificarlos
        antes con <code class="literal">uuencode</code> y decodificarlos después
        de transmitidos con <code class="literal">uudecode</code>. Para codificar
        un archivo <code class="literal">prog.tgz</code> y dejarlo codificado en
        <code class="literal">prog.tgz.uue</code>:
      </p><pre class="programlisting">
    uuencode prog.tgz &lt; prog.tgz &gt; prog.tgz.uue
</pre><p>
        posteriormente para decodificarlo:
      </p><pre class="programlisting">
    uudecode prog.tgz.uue
</pre><p>
        El inconveniente del método descrito es que
        <code class="literal">tip</code> no verifica la información transmitida.
        Una alternativa es emplear un protocolo como Zmodem. Para eso
        instale tanto en cliente como en servidor el paquete
        <code class="literal">zmtx-zmrx</code> (o <code class="literal">lrzsz</code>).
        Cuando desee transmitir un archivo del servidor al cliente,
        inicie la transmisión en el servidor:
      </p><pre class="programlisting">
    zmtx Mattich2.pdf
</pre><p>
        y en el cliente desde <code class="literal">tip</code> use
        <code class="literal">~C zmrx</code>. Para enviar un archivo del cliente
        al servidor ejecute en el servidor: <code class="literal">zmrx</code> y
        después desde <code class="literal">tip</code> use:
        <code class="literal">~C zmtx miarchivo.txt</code>
      </p></div><div class="sect3" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="ppp-sobre-modem-nulo"></a>3.1.4. PPP sobre Módem Nulo</h4></div></div></div><p>
        Una vez esté conectado un cliente con un servidor OpenBSD, es
        posible emplear el protocolo PPP<sup>[<a name="idp1667267024" href="#ftn.idp1667267024">18</a>]</sup> para permitirle al computador cliente acceder a
        Internet o a la red a la que esté conectado el servidor.
      </p><p>
        Una forma posible para lograr conectividad a Internet en una
        Intranet es asignando una dirección estática de la red al
        cliente y empleando el servidor para que actúe como proxy a
        nivel ARP.
      </p><p>
        En el servidor asegúrese de tener en el archivo
        <code class="literal">/etc/ppp/ppp.conf</code>:
      </p><pre class="programlisting">
    default:
      set log Phase Chat LCP IPCP CCP tun command
      set device /dev/cua00
      set speed 115200
      set ctsrts on
      set dial ""
    
    modemnulo:
      set timeout 0
      set lqrperiod 10
      enable proxy
      enable lqr
      accept lqr
      allow users SuLogin
</pre><p>
        Remplazando <code class="literal">SuLogin</code>,
        <code class="literal">SuClave</code> y las direcciones de red por las
        apropiadas. Por su parte el archivo
        <code class="literal">/etc/ppp/ppp.conf</code> del cliente debe contener:
      </p><pre class="programlisting">
    default:
     set log Phase Chat LCP IPCP CCP tun command
     set device /dev/cua00
     set speed 115200
     set ctsrts on
     set dial ""
    
    modemnulo:
      set dial ""
      set authkey SuClave
      set login "TIMEOUT 3 ogin:-\\r-login: SuLogin word: \\P $ ppp\\s\\-direct\\smodemnulo\\r"
      set lqrperiod 10
      set timeout 0
      set ifaddr 192.168.16.20 192.168.16.131
      add default HISADDR
      enable lqr
      accept lqr
      enable dns
</pre><p>
        Después pude iniciar la comunicación desde el cliente con:
      </p><pre class="programlisting">
    ppp -ddial modemnulo
</pre></div><div class="sect3" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="referencias-modem-nulo"></a>3.1.5. Referencias y lecturas recomendadas</h4></div></div></div><p>
        Puede consultar más sobre la conexión física de un módem nulo en
        <a href="biblio.html" title="B. Bibliografía">CablesModemNulo</a>. Puede consultar
        sobre comunicaciones seriales en FreeBSD (similar a OpenBSD) en
        el capítulo “<span class="quote">Serial Communications</span>” de
        <a href="biblio.html" title="B. Bibliografía">FreeBSDHandbook</a> Para emplear un
        sistema OpenBSD mínimo como consola de algunos eventos de un
        servidor OpenBSD puede consultar
        <a href="biblio.html" title="B. Bibliografía">SerialOpenBSD</a>. La configuración
        del servidor OpenBSD que le permite atender conexiones por el
        puerto serial puede verse en las siguientes páginas man: init 8,
        ttys 5 y getty 8. La configuración de un cliente OpenBSD para
        funcionar como consola puede consultarse en: tip 1 y remote 5.
        Para conocer más sobre PPP puede consultarse el
        <a href="ftp://ftp.rfc-editor.org/in-notes/rfc1661.txt" target="_top">RFC
        1661</a>, la implementación particular de el protocolo de
        usuario en OpenBSD en la página del manual. El archivo de
        configuración por defecto también cuenta con comentarios que
        ayudan.
      </p></div></div><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="modem-isdn"></a>3.2. Conexión a Internet con un módem o módem ISDN</h3></div></div></div><p>
      Es posible conectar un sistema OpenBSD a Internet empleando un
      módem o un módem ISDN. Para esto el módem que se emplea debe estar
      soportado y debe configurarse <code class="literal">ppp</code> para realizar
      la conexión.
    </p><p>
      Hay diversos tipos de módems (tarjetas ISA, PCI, módems externos
      USB o seriales), los módems externos que se conectan a puerto
      serial son los más fáciles de configurar, algunos módems USB
      también son soportados (los que tengan órdenes multiplexadas y
      datos –como indica la página del manual del controlador
      <code class="literal">umodem</code>) y eventualmente es posible hacer
      funcionar tarjetas ISDN ISA o PCI
      (<a href="http://people.freebsd.org/~hm/i4b-home/" target="_top">http://people.freebsd.org/~hm/i4b-home/</a>).
    </p><p>
      Los módems y los módems ISDN reciben órdenes AT y se configuran
      empleando <code class="literal">ppp</code>. Por ejemplo el archivo
      <code class="literal">/etc/ppp/ppp.conf</code> podría incluir porciones como
      las siguientes (remplazando el número de teléfono, el nombre de la
      cuenta y la clave por los correctos):
    </p><pre class="programlisting">
    default:
      set log Phase Chat LCP IPCP CCP tun command
      set device /dev/cua01
      set speed 115200
      set dial "ABORT BUSY ABORT NO\\sCARRIER TIMEOUT 5 \"\" AT \
        OK-AT-OK ATE1Q0 OK \\dATDT\\T TIMEOUT 40 CONNECT"
    
    
    PAP:
     set phone 019478909891 
     set authname micuenta@miproveedor.com
     set authkey laclaveusada
     set timeout 120
     add default HISADDR
     enable dns
</pre><p>
      Para conectarse ejecute
      <code class="literal">/usr/sbin/ppp -ddial PAP</code> desde una cuenta que
      pertenezca al grupo <code class="literal">network</code>. Cuando se
      establezca la conexión quedará asociada una dirección IP a una
      interfaz <code class="literal">tun</code> (e.g a <code class="literal">tun0</code>).
      Puede también emplear el siguiente script para realizar la
      conexión:
    </p><pre class="programlisting">
    #!/bin/sh
    
    # Usa configuración de /etc/ppp/ppp.conf regla PAP
    
    netw=`groups | sed -e "s/.*network.*/1/g"`;
    if (test "$netw" != "1") then {
        echo "Para usar PPP debe ser del grupo network";
        exit 1;
    } fi;
    
    IP=`/sbin/ifconfig tun0 | tail -n 1 | sed -e "s/.*inet \([.0-9]*\) .*/\1/g"`;
    esta=`echo $IP | sed -e "s/^[0-9][.0-9]*$/SI/g"`
    if (test "$esta" = "SI") then {
        echo "Ya está conectado, IP es $IP";
        exit 0;
    } fi;
    /usr/sbin/ppp -ddial PAP
    while (test "$esta" != "SI") ; do
        sleep 1;
        IP=`/sbin/ifconfig tun0 | tail -n 1 | sed -e "s/.*inet \([.0-9]*\) .*/\1/g"`;
        esta=`echo $IP | sed -e "s/^[0-9][.0-9]*$/SI/g"`
    done
    
    echo "Conectado. La IP es $IP";
</pre><p>
      Y el siguiente que facilita la desconexión:
    </p><pre class="programlisting">
    pid=`ps ax | grep "[p]pp" | sed -e "s/^[ ]*\([0-9]*\) .*$/\1/g"`;
    espid=`echo $pid | sed -e "s/^[0-9][0-9]*$/SI/g"`;
    if (test "$espid" != "SI") then {
      echo "No está conectado";
      exit 1;
    } fi;
    kill -HUP $pid
    echo "Desconectado";
</pre></div><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="adsl-pppoe"></a>3.3. Conexión a Internet ADSL con pppoe</h3></div></div></div><p>
      En Colombia los proveedores de acceso a Internet en planes de
      Banda Ancha típicamente emplean dispositivos y configuraciones que
      permiten conectar un computador como si fuera un equipo más en una
      red Ethernet. En tal caso basta conocer la IP que tendrá el
      computador (o si se usará dhcp), la mascara de red y la dirección
      de la puerta de enlace, y configurar como se explica en la sección
      de redes LAN Ethernet (ver
      <a href="dispositivos_de_interconexion.html#lan-ethernet" title="3.4. Uso y configuración en una red LAN Ethernet">Sección 3.4, “Uso y configuración en una red LAN Ethernet”</a>.
    </p><p>
      Puede ocurrir que su proveedor emplee un módem que requiera el
      protocolo <code class="literal">pppoe</code> (e.g con un Módem Marconi). En
      tal caso el proveedor puede brindar dos opciones para la
      configuración del módem:
    </p><div class="itemizedlist"><ul type="disc"><li><p>
          Enrutador (router): Se conecta a un HUB o a un computador y
          hace NAT para todos los computadores cliente conectados. En la
          LAN basta configurar la IP de cada equipo para que estén en la
          misma subred del enrutador y que cada uno emplee como
          compuerta/pasarela al módem.
        </p></li><li><p>
          Puente (bridge): En esta configuración se requiere un servidor
          que haga NAT y enrute.
        </p></li></ul></div><p>
      Si el módem ADSL se conecta con un cable Ethernet y el proveedor
      ofrece ppp, no debe configurarse la tarjeta de red, sino una
      interfaz nueva tun0 Por esto en el archivo de configuración de la
      tarjeta digamos <code class="literal">/etc/hostname.rl0</code> (reemplazar
      <code class="literal">rl0</code> con interfaz en su caso, examinar posibles
      interfaces con <code class="literal">ifconfig</code>) deje:
    </p><pre class="programlisting">
    up
    
</pre><p>
      Edite <code class="literal">/etc/ppp/ppp.conf</code> (si no existe cópielo
      de <code class="literal">/etc/ppp/ppp.conf.smaple</code>), para que quede
      una sección como la siguiente:
    </p><pre class="programlisting">
    pppoe:
     set log Phase Chat LCP IPCP CCP tun command
     set redial 15 0
     set reconnect 15 10000
     set device "!/usr/sbin/pppoe -i rl0"
     set mtu max 1492
     set mru max 1492
     set speed sync
     disable acfcomp protocomp
     deny acfcomp
     enable lqr
     set lqrperiod 5
     set cd 5
     set dial
     set login
     set timeout 0
     set authname "usuario"
     set authkey "miclave"
     add! default HISADDR
     enable mssfixup
    
</pre><p>
      Cambiando la interfaz de red, el usuario y la clave. Podrá probar
      la conexión con:
    </p><pre class="programlisting">
    ppp -ddial -nat pppoe
    
</pre><p>
      Si desea que en cada arranque se conecte automáticamente, tal como
      se explica en
      <a href="http://www.aei.ca/~pmatulis/pub/obsd_pppoe.html" target="_top">http://www.aei.ca/~pmatulis/pub/obsd_pppoe.html</a>
      agregue a <code class="literal">/etc/rc.local</code>:
    </p><pre class="programlisting">
    IPADSL=$(netstat -rn | grep tun0 | grep ^[0-9] | awk '{print$2}')
    if [ -z "$IPADSL" ]; then
        echo -n "Estableciendo conexion PPPoE DSL"; ppp -ddial pppoe
        for i in 10 9 8 7 6 5 4 3 2 1 0; do 
            sleep 5             
            echo -n "$i"        
            IPADSL=$(netstat -rn | grep tun0 | grep ^[0-9] | awk '{print$2}')
            if [ -z "$IPADSL" ]; then
                    break
            fi                  
        done     
    fi
</pre><div class="sect3" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="referencias-pppoe"></a>3.3.1. Referencias y lecturas recomendadas</h4></div></div></div><p>
        Página del manual <code class="literal">pppoe</code>.
      </p><p>
        http://www.aei.ca/~pmatulis/pub/obsd_pppoe.html
      </p></div></div><div class="sect2" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="lan-ethernet"></a>3.4. Uso y configuración en una red LAN Ethernet</h3></div></div></div><p>
      La red local (LAN) Ethernet más simple puede conformarse con 2
      computadores cada uno con tarjeta ethernet interconectados por un
      cable UTP cruzado. Sin embargo típicamente una red ethernet consta
      de varios computadores con tarjetas Ethernet interconectados por
      uno o más<sup>[<a name="idp1667338192" href="#ftn.idp1667338192">19</a>]</sup> concentradores (también llamado
      <span class="emphasis"><em>hub</em></span> o <span class="emphasis"><em>switch</em></span>) y cables
      UTP directos de cada computador a algún concentrador. La velocidad
      de la red depende de la velocidad de las tarjetas de red, la
      velocidad de los concentradores y la categoría de los cables. Esta
      velocidad se mide en Megabits (millones de bits por segundo), y
      sus valores típicos son 10Mb, 100Mb, 1000Mb o 1Gb y recientemente
      10Gb.
    </p><div class="sect3" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="tarjetas-ethernet"></a>3.4.1. Tarjetas Ethernet</h4></div></div></div><p>
        La inmensa mayoría de tarjetas Ethernet de 10MB, 100MB y 1000MB,
        así como algunas de 10G son soportadas por OpenBSD, la lista
        completa la puede consultar en:
        <a href="http://www.openbsd.org/amd64.html" target="_top">http://www.openbsd.org/amd64.html</a>.
        Por su parte las tarjetas populares que hemos identificado como
        no soportadas son: Encore ENL832-TX-RENT, Encore ENL832-TX-EN.
      </p><p>
        En cada computador, cada dispositivo de interconexión se asocia
        a una interfaz de red cuando es detectado en el momento del
        arranque (o por demanda como en el caso de
        <code class="literal">tun0</code>). Estas interfaces se administran con
        <code class="literal">ifconfig</code>, por ejemplo para listarlas todas
        utilice:
      </p><pre class="programlisting">
    ifconfig -a
</pre><p>
        A continuación se presenta un ejemplo de la salida de esta
        orden:
      </p><pre class="programlisting">
    lo0: flags=8049&lt;UP,LOOPBACK,RUNNING,MULTICAST&gt; mtu 33160
        priority: 0
        groups: lo
        inet 127.0.0.1 netmask 0xff000000
        inet6 ::1 prefixlen 128
        inet6 fe80::1%lo0 prefixlen 64 scopeid 0x6
    re0: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
        lladdr 00:14:d1:1a:cf:b2
        priority: 0
        groups: egress
        media: Ethernet autoselect (100baseTX full-duplex,rxpause,txpause)
        status: active
        inet 189.148.51.41 netmask 0xffffff00 broadcast 189.148.51.255
        inet6 fe80::214:d1ff:fe1a:cfb2%re0 prefixlen 64 scopeid 0x1
    re1: flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
        lladdr 00:14:d1:1a:ce:93
        priority: 0
        media: Ethernet autoselect (1000baseT full-duplex)
        status: active
        inet 192.168.2.1 netmask 0xffffff00 broadcast 192.168.2.255
        inet6 fe80::214:d1ff:fe1a:ce93%re1 prefixlen 64 scopeid 0x2
    re2: flags=8802&lt;BROADCAST,SIMPLEX,MULTICAST&gt; mtu 1500
        lladdr 00:14:d1:1a:cf:af
        priority: 0
        media: Ethernet autoselect (10baseT half-duplex)
        status: no carrier
    vr0: flags=8843LGUP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
        lladdr 00:19:db:82:8f:93
        priority: 0
        media: Ethernet autoselect (100baseTX full-duplex)
        status: active
        inet 192.168.1.1 netmask 0xffffff00 broadcast 192.168.1.255
        inet6 fe80::219:dbff:fe82:8f93%vr0 prefixlen 64 scopeid 0x4
    enc0: flags=0LG&gt; mtu 1536
        priority: 0
    pflog0: flags=141LGUP,RUNNING,PROMISC&gt; mtu 33160
        priority: 0
        groups: pflog
</pre><p>
        Es como una tabla con 2 columnas, en la de la izquierda se lista
        el nombre de la interfaz de red (en este ejemplo
        <code class="literal">lo0</code>, <code class="literal">re0</code>,
        <code class="literal">re1</code>, <code class="literal">re2</code>,
        <code class="literal">vr0</code>, <code class="literal">enc0</code>,
        <code class="literal">pflog0</code>), y a la derecha las características
        de cada interfaz, por ejemplo las características de la interfaz
        <code class="literal">re0</code> son:
      </p><pre class="programlisting">
    flags=8843&lt;UP,BROADCAST,RUNNING,SIMPLEX,MULTICAST&gt; mtu 1500
    lladdr 52:74:f2:b1:a8:7f
    priority: 0
    groups: egress
    media: Ethernet autoselect (100baseTX full-duplex,rxpause,txpause)
    status: active
    inet 189.148.51.41 netmask 0xffffff00 broadcast 189.148.51.255
    inet6 fe80::5074:f2ff:feb1:a87f%re0 prefixlen 64 scopeid 0x1
</pre><p>
        Algunas de las interfaces corresponden a tarjetas de red (en
        este ejemplo <code class="literal">re0</code>, <code class="literal">re1</code>,
        <code class="literal">re2</code> y <code class="literal">vr0</code>) mientras que
        otras son virtuales, como <code class="literal">lo0</code> que representa
        el mismo computador, <code class="literal">enc0</code> que sirve para
        cifrados con IPSec y <code class="literal">pflog0</code> que permite
        examinar en tiempo real actividad del cortafuegos
        <code class="literal">pf</code>.
      </p><p>
        Con respecto a las propiedades de cada interfaz física,
        resaltamos
      </p><div class="variablelist"><dl><dt><span class="term">
            <code class="literal">status</code>
          </span></dt><dd><p>
              Puede ser <code class="literal">active</code> para indicar que hay
              cable conectado a la tarjeta en un extremo y el otro
              extremo está conectado a algún concentrador (o a otro
              computador si es cruzado). Note que en el ejemplo la
              interfaz <code class="literal">re2</code> no está conectada.
            </p></dd><dt><span class="term">
            <code class="literal">lladdr</code>
          </span></dt><dd><p>
              Con la dirección MAC de la tarjeta de red (un número único
              para cada tarjeta fabricada).
            </p></dd><dt><span class="term">
            <code class="literal">inet</code>
          </span></dt><dd><p>
              Propiedades IPv4, por ejemplo:
            </p><pre class="programlisting">
    inet 189.148.51.41 netmask 0xffffff00 broadcast 189.148.51.255
</pre><p>
              Indica que la IP es 189.148.51.41, con mascara de red
              255.255.255.0 (en hexadecimal 255 es
              <code class="literal">ff</code>), y dirección para envíos masivos
              (broadcast) 189.148.51.255.
            </p></dd><dt><span class="term">
            <code class="literal">inet6</code>
          </span></dt><dd><p>
              Propiedades IPv6, por ejemplo:
            </p><pre class="programlisting">
    inet6 fe80::5074:f2ff:feb1:a87f%re0 prefixlen 64 scopeid 0x1
</pre><p>
              Indica que la dirección IPv6 es
              <code class="literal">fe80::214:d1ff:fe1a:cfb2%re0</code>. En este
              caso se trata de una dirección de enlace local (porque
              comienza con <code class="literal">fe80</code>) que se asigna
              automáticamente a la inetrfaz de red cuando se configura
              IPv6 a partir de la dirección MAC. Como se indica en
              https://ben.akrin.com/?p=1347 el proceso para asignarla
              es:
            </p><div class="orderedlist"><ol type="1" compact><li><p>
                  Tome la dirección mac. Por ejemplo 52:74:f2:b1:a8:7f
                </p></li><li><p>
                  Ponga un ff:fe en la mitad: 52:74:f2:ff:fe:b1:a8:7f
                </p></li><li><p>
                  Reformatee en notación IPv6 5274:f2ff:feb1:a87f
                </p></li><li><p>
                  Convierta e primero octeto de hexadecimal a binario:
                  52 -&gt; 01010010
                </p></li><li><p>
                  Invierta el bit en el índice 7: 01010010 -&gt;
                  01010000
                </p></li><li><p>
                  Convierta el octeto de vuelta a hexadecimal: 01010000
                  -&gt; 50
                </p></li><li><p>
                  Remplace el primer octeto con el que calculó:
                  5074:f2ff:feb1:a87f
                </p></li><li><p>
                  Ponga antes fe80:: que es el prefijo de enlace local:
                  fe80::5074:f2ff:feb1:a87f
                </p></li><li><p>
                  !Listo!
                </p></li></ol></div></dd><dt><span class="term">
            <code class="literal">media</code>
          </span></dt><dd><p>
              Que indica tipo de medio físico que está conectado o
              configurado en esa interfaz. En el ejemplo presentado las
              interfaces <code class="literal">re0</code> y <code class="literal">vr0</code>
              están operando a 100Mb (Megabit), mientras que la interfaz
              <code class="literal">re1</code> está operando a 1Gb (Gigabit).
            </p></dd><dt><span class="term">
            <code class="literal">flags</code>
          </span></dt><dd><p>
              Que indica banderas que tiene activa la interfaz y la MTU
              (Unidad de transferencia máxima). Note que
              <code class="literal">lo0</code> es la única que tiene la bandera
              <code class="literal">LOOPBACK</code> la cual indica que esa
              interfaz es virtual y se refiere al mismo computador.
            </p></dd></dl></div><p>
        Los dispositivos reconocidos en el momento del arranque que se
        asocian a interfaces de red, así como los que no logran
        configurarse, pueden verse con:
      </p><pre class="programlisting">
    dmesg | less
</pre><p>
        Un ejemplo típico de una tarjeta Ethernet reconocida es:
      </p><pre class="programlisting">
    re0 at pci0 dev 8 function 0 "Realtek 8169" rev 0x10: RTL8169/8110SB (0x1000), apic 2 int 16 (irq 10), address 52:74:f2:b1:a8:7f
</pre><p>
        Note que se lista el nombre de la interfaz (i.e
        <code class="literal">re0</code>), los recursos de hardware que emplea y
        la dirección MAC (i.e <code class="literal">52:74:f2:b1:a8:7f</code>).
      </p><p>
        OpenBSD incluye documentación completa para cada tipo de
        dispositivo detectable (por ejemplo opciones); para el caso del
        controlador del ejemplo anterior puede verse con:
      </p><pre class="programlisting">
    man re
</pre></div><div class="sect3" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="configuracion-interfaz"></a>3.4.2. Configuración de una interfaz de red</h4></div></div></div><p>
        Debe configurar cada interfaz de red en un archivo con un nombre
        de la forma <code class="literal">/etc/hostname.interfaz</code>. Por
        ejemplo para el caso de la tarjeta con controlador
        <code class="literal">re</code> e interfaz asignada por el kernel en el
        arranque <code class="literal">re0</code>, seria
        <code class="literal">/etc/hostname.re0</code>.
      </p><p>
        Como se explica en <code class="literal">man hostname.if</code> en el caso
        de una red IPv4 con DHCP basta que ese archivo tenga la línea:
      </p><pre class="programlisting">
    inet autoconf
</pre><p>
        Y para una red con IPv6
      </p><pre class="programlisting">
    inet6 autoconf
</pre><p>
        Si el direccionamiento en la red local es estático, tal archivo
        debe tener en una línea separados por un espacio los siguientes
        datos (en este orden):
      </p><div class="itemizedlist"><ul type="disc"><li><p>
            Familia de direcciones. Tìpicamente <code class="literal">inet</code>
          </p></li><li><p>
            IP (e.g <code class="literal">189.148.51.41</code>)
          </p></li><li><p>
            Mascara de red (e.g <code class="literal">255.255.255.0</code>)
          </p></li><li><p>
            Dirección de broadcast o la palabra <code class="literal">NONE</code>
          </p></li><li><p>
            Eventualmente opciones
          </p></li></ul></div><p>
        La línea completa sería:
      </p><pre class="programlisting">
    inet 189.148.51.41 255.255.255.0 NONE
</pre><p>
        O en el caso de doble pila la dirección IPv4 seguida de la IPv6:
      </p><pre class="programlisting">
    inet 189.148.51.41 255.255.255.0 NONE
    inet6 3900:e9:8321::2
</pre><p>
        Un archivo como estos lo puede crear y/o editar con cualquier
        editor de texto (por ejemplo <code class="literal">mg</code> o
        <code class="literal">vim</code>). Si tiene sesión de X-Window puede
        emplear desde una terminal
      </p><pre class="programlisting">
    doas touch /etc/hostname.re0; doas xfw /etc/hostname.re0
</pre><p>
        Estas ediciones también las puede hacer en adJ con botón derecho
        sobre el escritorio Dispositivos-&gt;Red-&gt;Configurar
        Interfaces, que le permitirá editar cada uno de los archivos de
        cada interfaz de red detectada por ifconfig (excepto lo0, enc0,
        pflog0, tun).
      </p><div class="blockquote"><blockquote class="blockquote"><p>
          <span class="strong"><strong>Advertencia</strong></span>
        </p><p>
          Es importante que la línea del archivo
          <code class="literal">/etc/hostname.re0</code> que configura sus
          propiedades IPv4 y/o IPv6, termine con el caracter fin de
          línea, es decir que en el editor con el que la edite termine
          la línea con la tecla RETORNO.
        </p></blockquote></div><p>
        Y la IP de la compuerta de su red (ver
        <a href="direcciones_enrutamiento_transporte_y_cortafuegos.html#ipv4" title="5.1. Introducción a TCP/IPv4">Sección 5.1, “Introducción a TCP/IPv4”</a>) se configura en
        <code class="literal">/etc/mygate</code> que también debe editar con su
        editor preferido y que también debe terminar con fin de línea.
        Un ejemplo típico del contenido sería una línea con:
      </p><pre class="programlisting">
    189.148.51.1
</pre><p>
        O en el caso de doble pila las compuertas IPv4 e IPv6
      </p><pre class="programlisting">
    189.148.51.1
    inet 3900:e9:8321::2
</pre><p>
        Con adJ puede hacer botón derecho sobre el escritorio
        Dispositivos-&gt;Red-&gt;Configurar Puerta de Enlace.
      </p><p>
        Después de hacer cambios a la configuración de red es posible
        que pueda reiniciar el sistema de redes con:
      </p><pre class="programlisting">
    doas sh /etc/netstart
</pre><p>
        aunque en algunos casos es necesario reiniciar el computador.
      </p><p>
        Note que si ha cambiado una tarjeta de red es posible que antes
        de reiniciar debe reconfigurar el cortafuegos en el archivo
        <code class="literal">/etc/pf.conf</code>
      </p></div><div class="sect3" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="protocolo-arp-para-ipv4-sobre-ethernet"></a>3.4.3. Protocolo ARP para IPv4 sobre Ethernet</h4></div></div></div><p>
        La tabla del protocolo ARP asocia direcciones físicas de
        tarjetas de red conectadas a su red con direcciones IP. Para
        examinar tal tabla use:
      </p><pre class="programlisting">
    arp -a 
</pre></div></div><div class="footnotes"><br><hr width="100" align="left"><div class="footnote"><p xmlns="http://www.w3.org/TR/xhtml1/transitional"><sup>[<a name="ftn.idp1667258320" href="#idp1667258320">16</a>] </sup>
            Como parámetro getty recibe características de la línea que
            deben estar especificadas en
            <code xmlns="" class="literal">/etc/gettytab</code>. En este caso
            <code xmlns="" class="literal">std.9600</code> especifica la velocidad de
            transmisión. Empleando un módem nulo con control de flujo es
            posible emplear velocidades mayores hasta
            <code xmlns="" class="literal">std.115200</code>.
          </p></div><div class="footnote"><p xmlns="http://www.w3.org/TR/xhtml1/transitional"><sup>[<a name="ftn.idp1667470800" href="#idp1667470800">17</a>] </sup>
            banderas del inglés <span xmlns="" class="emphasis"><em>flags</em></span>
          </p></div><div class="footnote"><p xmlns="http://www.w3.org/TR/xhtml1/transitional"><sup>[<a name="ftn.idp1667267024" href="#idp1667267024">18</a>] </sup>
            PPP es un protocolo especificado en el RFC 1661.
          </p></div><div class="footnote"><p xmlns="http://www.w3.org/TR/xhtml1/transitional"><sup>[<a name="ftn.idp1667338192" href="#idp1667338192">19</a>] </sup>
          Pueden ponerse concentradores en cascada.
        </p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="redes_protocolos_e_internet.html">Anterior</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="section.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top">2. Redes, protocolos e Internet </td><td width="20%" align="center"><a accesskey="h" href="index.html">Inicio</a></td><td width="40%" align="right" valign="top"> 4. </td></tr></table></div></body></html>
