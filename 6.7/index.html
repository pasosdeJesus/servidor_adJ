<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>La distribución Aprendiendo de Jesús como servidor y cortafuegos</title><meta name="generator" content="DocBook XSL Stylesheets V1.68.1"><link rel="start" href="index.html" title="La distribución Aprendiendo de Jesús como servidor y cortafuegos"><link rel="next" href="ar01s02.html" title="2. Dispositivos de interconexión"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">La distribución Aprendiendo de Jesús como servidor y cortafuegos</th></tr><tr><td width="20%" align="left"> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ar01s02.html">Siguiente</a></td></tr></table><hr></div><div class="article" lang="es"><div class="titlepage"><div><div><h1 class="title"><a name="idm4018919424"></a>La distribución Aprendiendo de Jesús como servidor y cortafuegos</h1></div><div><div class="author"><h3 class="author"><span class="firstname">Vladimir</span> <span class="surname">Támara Patiño
		(vtamara@pasosdeJesus.org)</span></h3></div></div><div><div class="legalnotice"><a name="idm4018921344"></a><p>
		    Este documento y sus fuentes se ceden al dominio
		    público desde 2004.  Esta es la versión 6.7 de este documento, 
		    actualizada por última vez en 02/09/2020 para que corresponda a 
		    la distribución adJ de OpenBSD 6.7.  
		    No se ofrece garantía alguna, por el contrario se aprecia
		    que se envíen correcciones y sugerencias al autor.  Este
		    escrito se dedica a Dios por su infinita sabiduría.</p><p>
		    Agradecemos las correcciones de Luis Alejandro Cruz</p><p>
	La versión publicada más reciente está tanto
	<a href="http://pasosdejesus.github.io/servidor_adJ/" target="_top">en línea</a>  como
	<a href="servidor_adJ-6.7_html.tar.gz" target="_top">en archivo comprimido</a> 
	y como <a href="http://adJ.pasosdeJesus.org/pub/AprendiendoDeJesus/6.7/paquetes/servidor_adJ-6.7.tar.gz" target="_top">paquete para adJ/OpenBSD</a>.
	
	Sus fuentes en DocBook están disponibles en 
	<a href="https://github.com/pasosdeJesus/servidor_adJ/" target="_top">https://github.com/pasosdeJesus/servidor_adJ/</a>.
      </p></div></div></div><hr></div><div class="toc"><p><b>Tabla de contenidos</b></p><dl><dt><span class="sect1"><a href="index.html#introduccion">1. Introducción</a></span></dt><dt><span class="section"><a href="index.html#idm4018919040">1. Redes, protocolos e Internet</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idm2196937600">1.1. Internet</a></span></dt><dt><span class="section"><a href="index.html#idm662283776">1.2. Capas de una red TCP/IP sobre algunos medios físicos</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idm1489727104">1.2.1. Capa física</a></span></dt><dt><span class="section"><a href="index.html#idm662285568">1.2.2. Capa de enlace</a></span></dt><dt><span class="section"><a href="index.html#idm622505216">1.2.3. Capa de internet</a></span></dt><dt><span class="section"><a href="index.html#idm1585028224">1.2.4. Capa de transporte</a></span></dt><dt><span class="section"><a href="index.html#idm1585026304">1.2.5. Capa de aplicación</a></span></dt></dl></dd><dt><span class="section"><a href="index.html#idm3521817600">1.3. Lecturas recomendadas</a></span></dt></dl></dd><dt><span class="section"><a href="ar01s02.html">2. Dispositivos de interconexión</a></span></dt><dd><dl><dt><span class="section"><a href="ar01s02.html#idm2518665344">2.1. Conexión con un módem nulo</a></span></dt><dd><dl><dt><span class="section"><a href="ar01s02.html#idm1670286720">2.1.1. Módem Nulo</a></span></dt><dt><span class="section"><a href="ar01s02.html#idm8918016">2.1.2. Servidor</a></span></dt><dt><span class="section"><a href="ar01s02.html#idm2863925120">2.1.3. Terminal</a></span></dt><dt><span class="section"><a href="ar01s02.html#idm1027431808">2.1.4. PPP sobre Módem Nulo</a></span></dt><dt><span class="section"><a href="ar01s02.html#idm2989613568">2.1.5. Referencias y lecturas recomendadas</a></span></dt></dl></dd><dt><span class="section"><a href="ar01s02.html#idm2989613056">2.2. Conexión a Internet con un módem o módem ISDN</a></span></dt><dt><span class="section"><a href="ar01s02.html#idm4199475840">2.3. Conexión a Internet ADSL con pppoe</a></span></dt><dd><dl><dt><span class="section"><a href="ar01s02.html#idm4017777664">2.3.1. Referencias y lecturas recomendadas</a></span></dt></dl></dd><dt><span class="section"><a href="ar01s02.html#idm3077905152">2.4. Uso y configuración en una red LAN Ethernet</a></span></dt><dd><dl><dt><span class="section"><a href="ar01s02.html#idm3123333888">2.4.1. Tarjetas Ethernet</a></span></dt><dt><span class="section"><a href="ar01s02.html#idm3479813760">2.4.2. Configuración de una interfaz de red</a></span></dt><dt><span class="section"><a href="ar01s02.html#idm2586189440">2.4.3. Protocolo ARP</a></span></dt><dt><span class="section"><a href="ar01s02.html#idm273890432">2.4.4. Cableado de una red local</a></span></dt><dt><span class="section"><a href="ar01s02.html#idm2809366528">2.4.5. Referencias</a></span></dt></dl></dd><dt><span class="section"><a href="ar01s02.html#idm1214557696">2.5. Red Local Inalámbrica: uso y configuración</a></span></dt><dd><dl><dt><span class="section"><a href="ar01s02.html#idm1213491456">2.5.1. OpenBSD como cliente en una red inalámbrica</a></span></dt><dt><span class="section"><a href="ar01s02.html#idm4161972864">2.5.2. Dispositivo dedicado que obra como Punto de Acceso
      Inalámbrico</a></span></dt><dt><span class="section"><a href="ar01s02.html#idm3450393216">2.5.3. OpenBSD como Punto de Acceso Inalámbrico</a></span></dt><dt><span class="section"><a href="ar01s02.html#idm1437273088">2.5.4. Referencias</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="ar01s03.html">3. Direcciones, enrutamiento, transporte y cortafuegos</a></span></dt><dd><dl><dt><span class="section"><a href="ar01s03.html#idm3459950592">3.1. Introducción a TCP/IPv4</a></span></dt><dd><dl><dt><span class="section"><a href="ar01s03.html#idm2031775616">3.1.1. Tabla de Enrutamiento</a></span></dt><dt><span class="section"><a href="ar01s03.html#idm1999688704">3.1.2. Otros aspectos de configuración de redes en OpenBSD</a></span></dt></dl></dd><dt><span class="section"><a href="ar01s03.html#idm1611129600">3.2. NAT (Network Address Translation)</a></span></dt><dd><dl><dt><span class="section"><a href="ar01s03.html#idm4267534208">3.2.1. Referencias y lecturas recomendadas</a></span></dt></dl></dd><dt><span class="section"><a href="ar01s03.html#idm664761728">3.3. Cortafuegos: filtrado y túneles</a></span></dt><dd><dl><dt><span class="section"><a href="ar01s03.html#idm348391168">3.3.1. Referencias y lecturas recomendadas</a></span></dt></dl></dd><dt><span class="section"><a href="ar01s03.html#idm664761856">3.4. ftp-proxy: para usar ftp desde la red interna</a></span></dt><dd><dl><dt><span class="section"><a href="ar01s03.html#idm1715954816">3.4.1. Referencias y lecturas recomendadas</a></span></dt></dl></dd><dt><span class="section"><a href="ar01s03.html#idm32696704">3.5. Ejemplo del uso de PF en una DMZ</a></span></dt><dd><dl><dt><span class="section"><a href="ar01s03.html#idm819117568">3.5.1. Referencias y lecturas recomendadas</a></span></dt></dl></dd><dt><span class="section"><a href="ar01s03.html#idm1225170560">3.6. Control de ancho de banda</a></span></dt><dd><dl><dt><span class="section"><a href="ar01s03.html#idm819115904">3.6.1. Referencias y lecturas recomendadas</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="ar01s04.html">4. Protocolos de soporte y de usuario</a></span></dt><dd><dl><dt><span class="section"><a href="ar01s04.html#idm1930221824">4.1. Servicio DNS</a></span></dt><dd><dl><dt><span class="section"><a href="ar01s04.html#idm1930222080">4.1.1. Resolución de nombres</a></span></dt><dt><span class="section"><a href="ar01s04.html#idm556160512">4.1.2. Servidor recursivo unbound</a></span></dt><dt><span class="section"><a href="ar01s04.html#idm817946112">4.1.3. Servidor autoritario con NSD</a></span></dt><dt><span class="section"><a href="ar01s04.html#idm1922857472">4.1.4. named</a></span></dt><dt><span class="section"><a href="ar01s04.html#idm2906143360">4.1.5. Referencias y lecturas recomendadas</a></span></dt></dl></dd><dt><span class="section"><a href="ar01s04.html#idm2204961024">4.2. Servidor <code class="literal">ssh</code></a></span></dt><dd><dl><dt><span class="section"><a href="ar01s04.html#idm3068237696">4.2.1. Jaula sftp</a></span></dt><dt><span class="section"><a href="ar01s04.html#idm3635013504">4.2.2. Referencias y lecturas recomendadas</a></span></dt></dl></dd><dt><span class="section"><a href="ar01s04.html#idm3635015296">4.3. Protocolo DHCP</a></span></dt><dd><dl><dt><span class="section"><a href="ar01s04.html#idm1848171776">4.3.1. Configuración de un cliente DHCP</a></span></dt><dt><span class="section"><a href="ar01s04.html#idm1615617664">4.3.2. Configuración de un servidor DHCP</a></span></dt><dt><span class="section"><a href="ar01s04.html#idm1848171008">4.3.3. Referencias y lecturas recomendadas</a></span></dt></dl></dd><dt><span class="section"><a href="ar01s04.html#idm1848172544">4.4. Servidor <code class="literal">ntp</code></a></span></dt><dd><dl><dt><span class="section"><a href="ar01s04.html#idm1615618432">4.4.1. Referencias y lecturas recomendadas</a></span></dt></dl></dd><dt><span class="section"><a href="ar01s04.html#idm351051264">4.5. Servidor de correo electrónico</a></span></dt><dd><dl><dt><span class="section"><a href="ar01s04.html#idm310691328">4.5.1. Protocolo SMTP para enviar y recibir correo</a></span></dt><dt><span class="section"><a href="ar01s04.html#idm2048058240">4.5.2. Dominios virtuales</a></span></dt><dt><span class="section"><a href="ar01s04.html#idm3865024512">4.5.3. Protocolos para revisar correo</a></span></dt><dt><span class="section"><a href="ar01s04.html#idm4198216960">4.5.4. Combatiendo correo no solicitado con SpamAssassin</a></span></dt><dt><span class="section"><a href="ar01s04.html#idm2055790848">4.5.5. Correo desde el web (webmail)</a></span></dt><dt><span class="section"><a href="ar01s04.html#idm64814976">4.5.6. Listas de correo</a></span></dt></dl></dd><dt><span class="section"><a href="ar01s04.html#idm2423597184">4.6. Servidor <code class="literal">ftp</code></a></span></dt><dd><dl><dt><span class="section"><a href="ar01s04.html#idm528673408">4.6.1. Servicio FTP en una DMZ</a></span></dt><dt><span class="section"><a href="ar01s04.html#idm692832640">4.6.2. Referencias y lecturas recomendadas</a></span></dt></dl></dd><dt><span class="section"><a href="ar01s04.html#idm2689059456">4.7. Servidor web</a></span></dt><dd><dl><dt><span class="section"><a href="ar01s04.html#idm92748288">4.7.1. nginx</a></span></dt><dt><span class="section"><a href="ar01s04.html#idm3043217536">4.7.2. Certificados SSL gratuitos con Let’s Encrypt</a></span></dt><dt><span class="section"><a href="ar01s04.html#idm2308822400">4.7.3. OpenBSD httpd</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="ar01s05.html">5. Otros servicios que puede prestar el servidor</a></span></dt><dd><dl><dt><span class="section"><a href="ar01s05.html#idm1271863168">5.1. Cuotas</a></span></dt><dd><dl><dt><span class="section"><a href="ar01s05.html#idm540490880">5.1.1. Referencias y lecturas recomendadas</a></span></dt></dl></dd><dt><span class="section"><a href="ar01s05.html#idm540489216">5.2. Motor de bases de datos PostgreSQL</a></span></dt><dd><dl><dt><span class="section"><a href="ar01s05.html#idm109408384">5.2.1. Primera instalación del servidor</a></span></dt><dt><span class="section"><a href="ar01s05.html#idm3687046272">5.2.2. Habilitando autenticación</a></span></dt><dt><span class="section"><a href="ar01s05.html#idm29280896">5.2.3. Creación de una base de datos</a></span></dt><dt><span class="section"><a href="ar01s05.html#idm553782656">5.2.4. Uso de una base de datos</a></span></dt><dt><span class="section"><a href="ar01s05.html#idm2865141760">5.2.5. Cotejación en PostgreSQL</a></span></dt><dt><span class="section"><a href="ar01s05.html#idm1396888192">5.2.6. Copias de respaldo</a></span></dt><dt><span class="section"><a href="ar01s05.html#idm1396882944">5.2.7. Base PostgreSQL remota</a></span></dt><dt><span class="section"><a href="ar01s05.html#idm3890937216">5.2.8. Referencias y lecturas recomendadas</a></span></dt></dl></dd><dt><span class="section"><a href="ar01s05.html#idm2989474560">5.3. MariaDB</a></span></dt><dd><dl><dt><span class="section"><a href="ar01s05.html#idm1349161984">5.3.1. Uso básico</a></span></dt><dt><span class="section"><a href="ar01s05.html#idm1634363392">5.3.2. Cambio de la clave de administrador</a></span></dt><dt><span class="section"><a href="ar01s05.html#idm3295840512">5.3.3. Recuperación y backups</a></span></dt><dt><span class="section"><a href="ar01s05.html#idm2079100800">5.3.4. MariaDB y servidor web con chroot</a></span></dt><dt><span class="section"><a href="ar01s05.html#idm3301193344">5.3.5. Lecturas recomendadas</a></span></dt></dl></dd><dt><span class="section"><a href="ar01s05.html#idm575842688">5.4. Servidor ldapd</a></span></dt><dd><dl><dt><span class="section"><a href="ar01s05.html#idm3853755264">5.4.1. Instalación de ldapd</a></span></dt><dt><span class="section"><a href="ar01s05.html#idm494775424">5.4.2. Pruebas Iniciales con openldap-client</a></span></dt><dt><span class="section"><a href="ar01s05.html#idm2929390976">5.4.3. Adición de datos iniciales</a></span></dt><dt><span class="section"><a href="ar01s05.html#idm494776960">5.4.4. Instalación y configuración de
      <code class="literal">phpldapadmin</code></a></span></dt><dt><span class="section"><a href="ar01s05.html#idm1030361600">5.4.5. Referencias y lecturas recomendadas</a></span></dt></dl></dd><dt><span class="section"><a href="ar01s05.html#idm968893568">5.5. Autoridad certificadora interna</a></span></dt><dd><dl><dt><span class="section"><a href="ar01s05.html#idm746655616">5.5.1. Conceptos</a></span></dt><dt><span class="section"><a href="ar01s05.html#idm1564045696">5.5.2. Configuración de servidor</a></span></dt><dt><span class="section"><a href="ar01s05.html#idm2330626176">5.5.3. Generación de un par de certificados</a></span></dt><dt><span class="section"><a href="ar01s05.html#idm685471872">5.5.4. Uso de los certificados</a></span></dt><dt><span class="section"><a href="ar01s05.html#idm2475485696">5.5.5. Referencias</a></span></dt></dl></dd></dl></dd><dt><span class="appendix"><a href="novedades.html">A. Novedades</a></span></dt><dt><span class="appendix"><a href="biblio.html">B. Bibliografía</a></span></dt></dl></div><div class="sect1" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="introduccion"></a>1. Introducción</h2></div></div></div><p>En este escrito describimos el sistema operativo OpenBSD 
	    6.7 con los programas y características de la 
	    distribución Aprendiendo de Jesús (adJ) que se emplea en 
	    servidores seguros o cortafuegos conectados
      a Internet o en una Intranet.  Este escrito es complementario
      a <a href="biblio.html" title="B. Bibliografía">basico_adJ</a> y a 
      <a href="biblio.html" title="B. Bibliografía">usuario_adJ</a>,  el primero es para
      usuarios remotos y el segundo describe la instalación, uso 
      y configuración de programas y características típicas de 
      usuarios de escritorio.
    </p></div><div class="section" lang="es"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idm4018919040"></a>1. Redes, protocolos e Internet</h2></div></div></div><p>
    Las redes de computadores constan de medios de transmisión (e.g
    cables), dispositivos (e.g tarjetas de red) y programas (e.g pila
    TCP/IP del kernel) que permiten transmitir información entre
    computadores. Pueden clasificarse de acuerdo al tamaño (WAN de
    cobertura amplia como un país, MAN de cobertura metropolitana o LAN
    para edificios o salones) o de acuerdo a la estructura de sus
    protocolos (e.g el modelo OSI que consta de 7 capas de protocolos:
    física, enlace, red, transporte, sesión, presentación y aplicación),
    o de acuerdo a la distribución física de los medios de transmisión y
    dispositivos (e.g estrella, bus).
  </p><p>
    LAN es acrónimo de <span class="emphasis"><em>Local Area Network</em></span>, con este
    término se hace referencia a redes pequeñas (comúnmente menos de 100
    computadores) cuyos computadores están generalmente en un mismo
    espacio físico. Los principales usos de una red LAN son:
  </p><div class="itemizedlist"><ul type="disc"><li><p>
        Compartir información distribuida en los discos duros o medios
        de almacenamiento de cada computador.
      </p></li><li><p>
        Emplear recursos de un computador desde otro, o recursos
        conectados en red (por ejemplo una impresora).
      </p></li><li><p>
        Compartir una conexión a Internet.
      </p></li><li><p>
        Conformar una Intranet con servicios como correo,
        <span class="emphasis"><em>web</em></span>, ftp, <span class="emphasis"><em>news</em></span>.
      </p></li></ul></div><p>
    Un protocolo <sup>[<a name="idm2399305344" href="#ftn.idm2399305344">1</a>]</sup> es una serie de reglas que indican cómo debe ocurrir una
    comunicación entre dos computadores de una red; las reglas de un
    protocolo son seguidas por programas que se ejecutan en los
    computadores interconectados. Su computador puede tener procesos
    activos que esperan conexiones de otros computadores o procesos para
    iniciar protocolos (por ejemplo con <code class="literal">ps -ax</code> es
    posible que vea: <code class="literal">sshd</code>, <code class="literal">inetd</code>,
    <code class="literal">httpd</code>, <code class="literal">postgres</code>). A estos
    programas, que esperan conexiones, se les llama servicios<sup>[<a name="idm2399302144" href="#ftn.idm2399302144">2</a>]</sup>. Usted puede iniciar un protocolo con otro computador
    empleando el programa cliente adecuado, por ejemplo el cliente
    <code class="literal">ping</code> con:
  </p><pre class="programlisting">
    ping 127.0.0.1
</pre><p>
    iniciará el protocolo de ping (<code class="literal">ICMP</code>,
    <code class="literal">ECHO_REQUEST</code>) con el computador con dirección IP
    127.0.0.1 (su propio computador), un programa de su computador
    estará pendiente de conexiones de este tipo y seguirá el
    protocolo<sup>[<a name="idm4199590272" href="#ftn.idm4199590272">3</a>]</sup>.
  </p><p>
    Dado que estamos en paso de IPv4 a IPv6 también mencionamos que el
    mismo ejemplo con IPv6 (y protocolo ICMP6) es:
  </p><pre class="programlisting">
    ping6 ::1
</pre><p>
    Internet es una red mundial de redes que están interconectadas vía
    satélite, por cables submarinos, fibra óptica y muchos otros medios
    de transmisión financiados por estados y organizaciones. Las
    heterogeneidad de las redes que interconecta (e.g una LAN de un
    colegio con Linux, una LAN de una ONG con OpenBSD, una WAN de un
    banco con X.25) es superada con los protocolos TCP/IP. Para
    facilitar la conexión de una LAN a Internet, en esta sección se
    presenta una introducción a los aspectos de redes de Internet; los
    temas introducidos serán tratados en detalle en otras secciones
    aplicándolos especialmente al caso de redes Ethernet (ver
    <a href="ar01s02.html" title="2. Dispositivos de interconexión">Sección 2, “Dispositivos de interconexión”</a>,
    <a href="ar01s03.html" title="3. Direcciones, enrutamiento, transporte y cortafuegos">Sección 3, “Direcciones, enrutamiento, transporte y cortafuegos”</a>
    y <a href="ar01s04.html" title="4. Protocolos de soporte y de usuario">Sección 4, “Protocolos de soporte y de usuario”</a>).
  </p><div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="idm2196937600"></a>1.1. Internet</h3></div></div></div><p>
      Hay muchas personas que aportan su trabajo (muchos de forma
      voluntaria) para mantener Internet en funcionamiento, para
      solucionar problemas que ocurren y para planear su futuro. Quienes
      dirigen el rumbo de Internet están organizados en comités
      encargados de diversas actividades:
    </p><div class="variablelist"><dl><dt><span class="term">
          IETF Internet Engineering Task Force
        </span></dt><dd><p>
            Compuesta enteramente de voluntarios autoorganizados que
            colaboran en la ingeniería requerida para la evolución de
            Internet, es decir identifican problemas y proponen
            soluciones. Quien lo desee puede participar, asistir a las
            reuniones, ayudar a dar forma o proponer estándares. La IETF
            recibe borradores (<span class="emphasis"><em>Internet Draft</em></span>) de
            autores que renuncian al control del protocolo que proponen.
            Tras refinamiento estos borradores pueden llegar a ser RFC
            (<span class="emphasis"><em>Request for Comment</em></span>) de uno de estos
            tipos: estándar propuesto, protocolo experimental, documento
            informativo o estándar histórico. Un estándar propuesto
            puede después convertirse en borrador de estándar y en casos
            muy contados en estándar de Internet.
          </p></dd><dt><span class="term">
          ISOC Internet Society
        </span></dt><dd><p>
            Organización sin ánimo de lucro, da soporte legal y
            financiero a otros grupos.
          </p></dd><dt><span class="term">
          IESG Internet Engineering Steering Group
        </span></dt><dd><p>
            Ratifica o corrige estándares propuestos por la IETF.
          </p></dd><dt><span class="term">
          IAB Internet Architecture Board
        </span></dt><dd><p>
            Planeación a largo plazo y coordinación entre las diversas
            áreas.
          </p></dd><dt><span class="term">
          IANA Internet Assigned Numbers Authority
        </span></dt><dd><p>
            Mantienen registros de diversos nombres y números asignados
            a organizaciones. Es financiado por ICANN
            (<span class="emphasis"><em>Internet Corporation for Assigned Names and
            Numbers</em></span>).
          </p></dd><dt><span class="term">
          LACNIC Registro de Direcciones de Internet para América Latina
          y Caribe
        </span></dt><dd><p>
            Es responsable de la asignación y administración de los
            recursos de numeración de Internet (IPv4, IPv6), Números
            Autónomos y Resolución Inversa, entre otros recursos para la
            región de América Latina y el Caribe. Es uno de los 5
            Registros Regionales de Internet en el mundo.
          </p></dd></dl></div><p>
      La interconexión de las redes conectadas a Internet y su
      mantenimiento se basa en el protocolo IP, que asigna a cada red y
      a cada computador un número único (dirección IP) que permite
      identificarlo y enviarle información.
    </p><p>
      La asignación de direcciones IP<sup>[<a name="idm3073716096" href="#ftn.idm3073716096">4</a>]</sup> es manejada por IANA, que a su vez la ha delegado a
      registros en diversas regiones. La región de América Latina es
      manejada por el registro LACNIC, que recibe solicitudes para
      asignar bloques a proveedores de servicio a Internet (ISP) o
      usuarios, estos proveedores deben contar con la infraestructura
      para conectar sus computadores a Internet (e.g con cables
      submarinos, vía satélite) y a su vez ofrecen bloques de
      direcciones y conexión a otros proveedores o a usuarios.
    </p><p>
      Dada que la comunicación de dos computadores es un proceso
      complejo (aún más dada la variedad de redes conectadas a
      Internet), además de una basta infraestructura física, Internet se
      basa en varios protocolos que siguen todos los computadores y
      enrutadores conectados. Algunos de estos protocolos dependen de
      otros, dando lugar a varias capas de protocolos: aplicación,
      transporte, Internet, enlace<sup>[<a name="idm662284672" href="#ftn.idm662284672">5</a>]</sup>. El siguiente diagrama presenta algunos protocolos en
      las diversas capas de una red TCP/IP sobre una red física Ethernet
      o sobre una conexión con módem:
    </p><pre class="programlisting">
Capa de aplicación:
     Protocolos de usuario                FTP Telnet  ssh   http   SMTP ...
                                           |     |     |      |    |
     Protocolos de soporte      DNS  BGP   |     |     |      |    |
                               |   \  |    |     |     |      |    |
Capa de transporte             UDP   TCP --------------------------
                                \  /
Capa de Internet (red):        IP -  ICMP
                               ___|___
                              /       \
Capa de enlace:             ARP        PPP         OSPF
                             |          |
Capa física:           Ethernet     Modem
                        |              |
                     Par trenzado    Línea telef.
</pre></div><div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="idm662283776"></a>1.2. Capas de una red TCP/IP sobre algunos medios físicos</h3></div></div></div><div class="section" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="idm1489727104"></a>1.2.1. Capa física</h4></div></div></div><p>
        Se refiere a las conexiones eléctricas y mecánicas de la red.
        Ejemplos de protocolos a este nivel son: Ethernet, Inalámbrico
        IEEE 802.11, Modem y fibra óptica. La información por transmitir
        se codifica en últimas como una señal eléctrica que debe
        transmitirse por cables o como una señal electromagnética (luz,
        ondas). En medios de transmisión compartidos por más
        computadores (Ethernet, fibra óptica, aire), el protocolo de
        este nivel debe tener en cuenta: codificación/decodificación de
        información del bus al medio de transmisión y arbitrar en caso
        de colisión de datos. Este tipo de protocolos es implementado
        por hardware, comúnmente por una tarjeta o dispositivo dedicado
        que se debe conectar al bus de cada computador. Las tarjetas de
        los computadores que se comunican se conectan empleando el medio
        de transmisión. OpenBSD, a nivel físico soporta dispositivos
        ethernet, fddi (fibra óptica) y conexiones inalámbricas. En caso
        particular de Ethernet, existen en el momento de este escrito
        estándares para 10Mbps, 100Mbps, 1Gbps y 10Gbps, que se emplean
        en topología de estrella (i.e. todos los computadores conectados
        por cables de pares trenzados a un concentrador), puede
        configurarse como <span class="emphasis"><em>Half-duplex</em></span> o como
        <span class="emphasis"><em>Full-Duplex</em></span>. Describiremos el uso del
        esquema más popular y económico en este momento: 1000Mbps,
        Full-duplex con cable de pares trenzados <sup>[<a name="idm12712832" href="#ftn.idm12712832">6</a>]</sup>. Cada tarjeta Ethernet tiene una dirección única
        (llamada dirección MAC), que en una transmisión permite indicar
        tarjeta fuente y tarjeta destino (la dirección MAC de ambos es
        transmitida también).
      </p></div><div class="section" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="idm662285568"></a>1.2.2. Capa de enlace</h4></div></div></div><p>
        Los protocolos de esta capa permiten interconectar la capa de
        internet (IP) con la red que se use.
      </p><p>
        En el caso de una red Ethernet e IPv4 se trata del protocolo
        ARP<sup>[<a name="idm12711936" href="#ftn.idm12711936">7</a>]</sup>, que se encarga de traducir direcciones IPv4 a
        direcciones MAC <sup>[<a name="idm12714752" href="#ftn.idm12714752">8</a>]</sup>.
      </p><p>
        Cada vez que un computador de una LAN identifica una dirección
        IPv4 de otro computador conectado a la LAN y su correspondiente
        dirección ARP, almacena la información en una tabla (se borra
        automáticamente después de algunos minutos o manualmente por
        ejemplo con <code class="literal">doas arp -d 192.168.2.2</code>). Dicha
        tabla puede consultarse con
      </p><pre class="programlisting">
    arp -a
</pre><p>
        Para monitorear una red Ethernet e IPv4 y detectar nuevos
        computadores que se conecten, puede emplearse el programa
        <code class="literal">arpwatch</code> (paquete
        <code class="literal">arpwatch</code>) que cada vez que detecta cambios
        envía un correo a la cuenta root.
      </p><p>
        En el caso de IPv6 y Ethernet se emplea el protocolo NDP
        (Neighbor Discovery Protocol). Puede examinarse la tabla de
        vecinos con <code class="literal">ndp -a</code>
      </p><p>
        En el caso de una conexión por modem el protocolo es
        PPP<sup>[<a name="idm3299160832" href="#ftn.idm3299160832">9</a>]</sup>, que se encarga de establecer, terminar y verificar
        la conexión. Durante la conexión autentica el computador que se
        conecta ante el servidor (bien con el protocolo PAP o con CHAP)
        y durante la operación prepara los paquetes enviados por otros
        protocolos (como IP) para transmitirlos por modem.
      </p><p>
        Cuando al interior de una organización (o sistema autonomo) hay
        diversas LANs que requieren decisiones de enrutamiento puede
        emplearse OSPF.
      </p></div><div class="section" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="idm622505216"></a>1.2.3. Capa de internet</h4></div></div></div><p>
        En esta capa la información es fragmentada y enviada empleando
        el protocolo de la capa física. Los protocolos de esta capa
        deben tener en cuenta la retransmisión de la información en caso
        de error al enviar y el verificar información recibida. En esta
        capa está el <span class="emphasis"><em>Internet Protocol</em></span> (IP) que es
        un protocolo diseñado para Internet y del cual hay dos
        versiones: IPv4 e IPv6. Describiremos la versión 4 <sup>[<a name="idm622505728" href="#ftn.idm622505728">10</a>]</sup> (la versión 6 fue diseñada para soportar más
        computadores conectados a Internet y se espera que pronto se use
        ampliamente <sup>[<a name="idm662284928" href="#ftn.idm662284928">11</a>]</sup>).
      </p><p>
        Este protocolo permite la transmisión de paquetes (llamados
        datagramas) en redes donde cada computador interconectado se
        identifica con una dirección única. Tales direcciones están
        diseñadas para interconectar varias redes, identificar los
        computadores que pertenecen a una red (empleando una máscara de
        red que indica que parte de la dirección del computador
        corresponde a la dirección de la red) y facilitar el
        enrutamiento. Si el medio de transmisión lo requiere, el
        protocolo IP se encarga de la división de los datagramas en
        paquetes más pequeños para su transmisión y de la posterior
        reagrupación (fragmentación), el tamaño máximo que un paquete
        puede tener para un protocolo de nivel físico se llama MTU
        (<span class="emphasis"><em>Maximal Transfer Unit</em></span>), en el caso de
        Ethernet es 1500 bytes.
      </p><p>
        Cada datagrama por transmitir es pasado a la capa de IP por otro
        protocolo de una capa superior (e.g TCP) junto con dirección
        destino, IP mantiene una tabla de enrutamiento que asocia
        direcciones destino con compuertas (computadores intermediarios
        en inglés <span class="emphasis"><em>gateways</em></span>). Así que envía el
        datagrama empleando el nivel físico a la dirección de la
        compuerta que mantenga en su tabla de enrutamiento. La tabla de
        enrutamiento puede ser modificada manualmente (con
        <code class="literal">route show</code>) o puede ser modificada
        automáticamente cuando una compuerta envía un mensaje indicando
        la dirección de otra compuerta más apropiada para llegar a una
        dirección. Hay siempre una compuerta por defecto a la que se
        envían paquetes que IP no sepa como enrutar.
      </p><p>
        IP no es protocolo fiable, porque no asegura que un paquete
        llegue a su destino y no realiza retransmisiones. Aunque para
        informar algunas situaciones anómalas emplea el protocolo ICMP
        <sup>[<a name="idm3299158272" href="#ftn.idm3299158272">12</a>]</sup>.
      </p><p>
        OpenBSD cuenta con una excelente implementación de IPv4 con
        posibilidad de filtrar, redirigir, traducir direcciones,
        balancear carga y muchas otras opciones que se configuran de
        forma sencilla con PF. Además implementa características no
        estándar como IPsec para transmisión cifrada y IPcomp para
        comprimir.
      </p></div><div class="section" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="idm1585028224"></a>1.2.4. Capa de transporte</h4></div></div></div><p>
        Los protocolos de esta capa asegura una conexión continua y
        posiblemente libre de errores entre emisor y receptor. Un
        protocolo de esta capa debe tener en cuenta mantener los
        paquetes en orden y asegurar que están completos. Esto se
        requiere porque el nivel de red puede enrutar diversos paquetes
        de forma diferente. En esta capa hay dos protocolos:
        TCP<sup>[<a name="idm1585029760" href="#ftn.idm1585029760">13</a>]</sup> y UDP<sup>[<a name="idp3163008" href="#ftn.idp3163008">14</a>]</sup>. El primero es fiable, asegura que la transmisión
        enviada sea recibida, UDP por su parte no busca confirmar que la
        información llegue a su destino (aunque permite hacer
        difusión<sup>[<a name="idp3161216" href="#ftn.idp3161216">15</a>]</sup> y multidifusión<sup>[<a name="idm785563008" href="#ftn.idm785563008">16</a>]</sup> mientras que TCP no). Ambos protocolos emplean
        puertos para permitir más de una conexión con uno o más
        computadores, un puerto se identifica con un número entre 0 y
        65536, los primeros 1024 números sólo pueden ser usados por
        servidores iniciados desde la cuenta root, los demás pueden ser
        usados por todos los usuarios.
      </p><p>
        Puede examinar información sobre conexiones a puertos TCP y UDP
        con <code class="literal">doas pfctl -sa</code>
      </p></div><div class="section" lang="es"><div class="titlepage"><div><div><h4 class="title"><a name="idm1585026304"></a>1.2.5. Capa de aplicación</h4></div></div></div><p>
        Consta de protocolos empleados por aplicaciones con propósitos
        específicos. Emplean los protocolos de la capa de transporte
        para establecer comunicación. Los protocolos de esta capa pueden
        dividirse a su vez en protocolos de usuario y protocolos de
        soporte. Los primeros son para programas empleados directamente
        por usuarios y los segundos son empleados por el sistema
        operativo o por otros protocolos.
      </p><div class="section" lang="es"><div class="titlepage"><div><div><h5 class="title"><a name="idm4058338304"></a>1.2.5.1. Protocolos de usuario</h5></div></div></div><div class="variablelist"><dl><dt><span class="term">
              Telnet
            </span></dt><dd><p>
                Telnet está definido en el RFC 854 y complementado en el
                RFC 1123. Permite la operación remota de otro computador
                de forma insegura pues las claves se transmiten planas
                (ssh es un reemplazo seguro, ver
                <a href="ar01s04.html#idm2204961024" title="4.2. Servidor ssh">Sección 4.2, “Servidor <code class="literal">ssh</code>”</a>), además puede
                usarse para interactuar con otros protocolos (por
                ejemplo puede interactuar con el protocolo de correo
                SMTP de su propio computador —puerto 25— con
                <code class="literal">telnet localhost 25</code>).
              </p></dd><dt><span class="term">
              (<span class="emphasis"><em>File Transfer Protocol</em></span>) FTP
            </span></dt><dd><p>
                FTP está definido en el RFC 959 y complementado en el
                RFC 1123, permite transmisión de archivos de manera
                insegura pues las claves se transmiten planas (ver
                <a href="ar01s04.html#idm2423597184" title="4.6. Servidor ftp">Sección 4.6, “Servidor <code class="literal">ftp</code>”</a>).
              </p></dd><dt><span class="term">
              TFPT
            </span></dt><dd><p>
                Está definido en el RFC 1350 (<span class="emphasis"><em>Trivial File
                Transfer Protocol</em></span>), es análogo a FTP pues
                permite transmitir archivos, aunque es mucho más simple,
                es apropiado para transmitir el sistema operativo a
                computadores sin disco duro que arrancan por red.
              </p></dd><dt><span class="term">
              SMTP
            </span></dt><dd><p>
                SMTP se definió en el RFC 822 y se complementó en el RFC
                1123 (<span class="emphasis"><em>Simple Mail Transfer
                Protocol</em></span>) que especifica cómo se realiza la
                transmisión de correo electrónico (ver
                <a href="ar01s04.html#idm351051264" title="4.5. Servidor de correo electrónico">Sección 4.5, “Servidor de correo electrónico”</a>).
              </p></dd></dl></div></div><div class="section" lang="es"><div class="titlepage"><div><div><h5 class="title"><a name="idm785561728"></a>1.2.5.2. Protocolos de soporte</h5></div></div></div><div class="variablelist"><dl><dt><span class="term">
              DNS
            </span></dt><dd><p>
                Definido en los RFC 1034 y 1035 y complementado en el
                RFC 1123. Es empleado para dar nombres descriptivos a
                direcciones IP (e.g structio.sourceforge.net es el
                nombre DNS de la dirección 216.34.181.96).
              </p></dd><dt><span class="term">
              BOOTP
            </span></dt><dd><p>
                Empleado por un computador en el que no ha iniciado el
                sistema operativo para solicitar su dirección IP a un
                servidor de este protocolo.
              </p></dd><dt><span class="term">
              SMMP
            </span></dt><dd><p>
                Empleado para monitorear uso de una red.
              </p></dd><dt><span class="term">
              BGP
            </span></dt><dd><p>
                Determina enrutamiento de paquetes en Internet a partir
                de información de Sistemas Autónomos. Cómo se describe
                en el RFC 4271, un Sistema Autónomo (AS) es un conjunto
                de enrutadores bajo una única administración técnica que
                a la vista de otros AS tiene un plan de enrutamiento
                interior coherente y que presenta una imagen consistente
                de los destinos a los que se pueden llegar mediante el
                mismo.
              </p></dd></dl></div></div></div></div><div class="section" lang="es"><div class="titlepage"><div><div><h3 class="title"><a name="idm3521817600"></a>1.3. Lecturas recomendadas</h3></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>
          Puede consultar más sobre el IETF y otras organizaciones que
          mantienen Internet en <a href="biblio.html" title="B. Bibliografía">taioetf</a> y
          en <a href="biblio.html" title="B. Bibliografía">osietf</a>.
        </p></li><li><p>
          Puede consultar los RFC en
          <a href="biblio.html" title="B. Bibliografía">rfceditor</a>. También puede
          consultar versiones en castellano en
          <a href="biblio.html" title="B. Bibliografía">rfces</a>
        </p></li><li><p>
          Páginas del manual netintro4, ip4, inet4, ip4
        </p></li><li><p>
          https://en.wikipedia.org/wiki/Internet_protocol_suitehttps://en.wikipedia.org/wiki/Internet_protocol_suite
        </p></li><li><p>
          BGP y OSPF:
          https://www.openbsd.org/papers/linuxtag06-network/mgp00003.html
        </p></li></ul></div></div></div><div class="footnotes"><br><hr width="100" align="left"><div class="footnote"><p xmlns="http://www.w3.org/TR/xhtml1/transitional"><sup>[<a name="ftn.idm2399305344" href="#idm2399305344">1</a>] </sup>
        Para ampliar el significado de los términos técnicos
        introducidos en estas guías (como
        <span xmlns="" class="emphasis"><em>protocolo</em></span>), se sugiere consultar el
        diccionario FOLDOC
        <a xmlns="" href="">http://foldoc.doc.ic.ac.uk/foldoc</a>
      </p></div><div class="footnote"><p xmlns="http://www.w3.org/TR/xhtml1/transitional"><sup>[<a name="ftn.idm2399302144" href="#idm2399302144">2</a>] </sup>
        También suele llamárseles <span xmlns="" class="emphasis"><em>daemons</em></span> pero como
        puede resultar ofensivo para cristian@s, procuramos no emplear
        ese término, ver
        <a xmlns="" href="">http://aprendiendo.pasosdejesus.org/?id=Renombrando+Daemon+por+Servicio</a>.
      </p></div><div class="footnote"><p xmlns="http://www.w3.org/TR/xhtml1/transitional"><sup>[<a name="ftn.idm4199590272" href="#idm4199590272">3</a>] </sup>
        El programa que sigue este protocolo hace parte de la
        implementación de IPv4 en el kernel.
      </p></div><div class="footnote"><p xmlns="http://www.w3.org/TR/xhtml1/transitional"><sup>[<a name="ftn.idm3073716096" href="#idm3073716096">4</a>] </sup>
          Puede verse más sobre asignación de IPs en el RFC 2050 y sobre
          asignación de direcciones in redes IP privadas en RFC 1918.
        </p></div><div class="footnote"><p xmlns="http://www.w3.org/TR/xhtml1/transitional"><sup>[<a name="ftn.idm662284672" href="#idm662284672">5</a>] </sup>
          El RFC 1122 presenta las capas de una red TCP/IP
        </p></div><div class="footnote"><p xmlns="http://www.w3.org/TR/xhtml1/transitional"><sup>[<a name="ftn.idm12712832" href="#idm12712832">6</a>] </sup>
            El estándar que define este esquema es IEEE 802.3, que se
            basa en el uso de un sólo medio de transmisión compartido
            por todos los dispositivos en el que sólo trasmite un sólo
            dispositivo durante un tiempo para evitar colisiones, se
            elige el siguiente dispositivo por transmitir con el
            algoritmo CSMA/CD –cuando un dispositivo detecta que la
            línea está libre transmite parte de la información si
            detecta colisión da oportunidad de transmisión a otros un
            intervalo aleatorio de tiempo.
          </p></div><div class="footnote"><p xmlns="http://www.w3.org/TR/xhtml1/transitional"><sup>[<a name="ftn.idm12711936" href="#idm12711936">7</a>] </sup>
            ARP que se define en el RFC 826
          </p></div><div class="footnote"><p xmlns="http://www.w3.org/TR/xhtml1/transitional"><sup>[<a name="ftn.idm12714752" href="#idm12714752">8</a>] </sup>
            Un computador envía un mensaje a todos los demás de la red
            (que es posible por ejemplo en Ethernet), solicitando la
            dirección MAC de una dirección IPv4, el dispositivo con esa
            MAC responde enviando su dirección MAC al dispositivo que
            hizo la solicitud.
          </p></div><div class="footnote"><p xmlns="http://www.w3.org/TR/xhtml1/transitional"><sup>[<a name="ftn.idm3299160832" href="#idm3299160832">9</a>] </sup>
            PPP se describe en el RFC 1661.
          </p></div><div class="footnote"><p xmlns="http://www.w3.org/TR/xhtml1/transitional"><sup>[<a name="ftn.idm622505728" href="#idm622505728">10</a>] </sup>
            El protocolo IPv4 está descrito en el RFC 791, aunque puede
            verse una descripción en conjunto con otros protocolos en el
            RFC 1122
          </p></div><div class="footnote"><p xmlns="http://www.w3.org/TR/xhtml1/transitional"><sup>[<a name="ftn.idm662284928" href="#idm662284928">11</a>] </sup>
            OpenBSD tiene soporte para IPv6
          </p></div><div class="footnote"><p xmlns="http://www.w3.org/TR/xhtml1/transitional"><sup>[<a name="ftn.idm3299158272" href="#idm3299158272">12</a>] </sup>
            ICMP Internet Control Message Protocol, se describe en el
            RFC792, permite enviar mensajes de error (e.g dirección
            inalcanzable, tiempo excedido) y algunos mensajes para hacer
            consultas (e.g eco, estampilla de tiempo).
          </p></div><div class="footnote"><p xmlns="http://www.w3.org/TR/xhtml1/transitional"><sup>[<a name="ftn.idm1585029760" href="#idm1585029760">13</a>] </sup>
            TCP se describe en el RFC 793 y se complementa y corrige en
            el RFC 1122
          </p></div><div class="footnote"><p xmlns="http://www.w3.org/TR/xhtml1/transitional"><sup>[<a name="ftn.idp3163008" href="#idp3163008">14</a>] </sup>
            UDP está descrito en el RFC 768 y corregido en el RFC 1122
          </p></div><div class="footnote"><p xmlns="http://www.w3.org/TR/xhtml1/transitional"><sup>[<a name="ftn.idp3161216" href="#idp3161216">15</a>] </sup>
            Del inglés <span xmlns="" class="emphasis"><em>broadcast</em></span>
          </p></div><div class="footnote"><p xmlns="http://www.w3.org/TR/xhtml1/transitional"><sup>[<a name="ftn.idm785563008" href="#idm785563008">16</a>] </sup>
            Del inglés <span xmlns="" class="emphasis"><em>multicast</em></span>
          </p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ar01s02.html">Siguiente</a></td></tr><tr><td width="40%" align="left" valign="top"> </td><td width="20%" align="center"> </td><td width="40%" align="right" valign="top"> 2. Dispositivos de interconexión</td></tr></table></div></body></html>
